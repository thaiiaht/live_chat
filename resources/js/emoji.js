        const emojiData = {
            smileys: {
                name: 'Mặt cười và hình người',
                icon: '😊',
                emojis: [
                    '😀', '😃', '😄', '😁', '😆', '😅', '🤣', '😂',
                    '🙂', '🙃', '😉', '😊', '😇', '🥰', '😍', '🤩',
                    '😘', '😗', '😚', '😙', '😋', '😛', '😜', '🤪',
                    '😝', '🤑', '🤗', '🤭', '🤫', '🤔', '🤐', '🤨',
                    '😐', '😑', '😶', '😏', '😒', '🙄', '😬', '🤥',
                    '😌', '😔', '😪', '🤤', '😴', '😷', '🤒', '🤕',
                    '🤢', '🤮', '🤧', '🥵', '🥶', '🥴', '😵', '🤯',
                    '🤠', '🥳', '😎', '🤓', '🧐', '😕', '😟', '🙁',
                    '☹', '😮', '😯', '😲', '😳', '🥺', '😦', '😧',
                    '😨', '😰', '😥', '😢', '😭', '😱', '😖', '😣'
                ]
            },
            people: {
                name: 'Con người và cơ thể',
                icon: '👋',
                emojis: [
                    '👋', '🤚', '🖐', '✋', '🖖', '👌', '🤌', '🤏',
                    '✌', '🤞', '🤟', '🤘', '🤙', '👈', '👉', '👆',
                    '🖕', '👇', '☝️', '👍', '👎', '✊', '👊', '🤛',
                    '🤜', '👏', '🙌', '👐', '🤲', '🤝', '🙏', '✍️',
                    '💅', '🤳', '💪', '🦾', '🦿', '🦵', '🦶', '👂',
                    '🦻', '👃', '🧠', '🦷', '🦴', '👀', '👁', '👅',
                    '👄', '💋', '👶', '🧒', '👦', '👧', '🧑', '👨',
                    '👩', '🧔',                     '🧑', '👨', '👩', '🧔', '👱', '👲'
                ]
            },
            animals: {
                name: 'Động vật và thiên nhiên',
                icon: '🐶',
                emojis: [
                    '🐶', '🐱', '🐭', '🐹', '🐰', '🦊', '🐻', '🐼',
                    '🐨', '🐯', '🦁', '🐮', '🐷', '🐽', '🐸', '🐵',
                    '🙈', '🙉', '🙊', '🐒', '🐔', '🐧', '🐦', '🐤',
                    '🐣', '🐥', '🦆', '🦅', '🦉', '🦇', '🐺', '🐗',
                    '🐴', '🦄', '🐝', '🐛', '🦋', '🐌', '🐞', '🐜',
                    '🦟', '🦗', '🕷', '🕸', '🦂', '🐢', '🐍', '🦎',
                    '🦖', '🦕', '🐙', '🦑', '🦐', '🦞', '🦀', '🐡',
                    '🐠', '🐟', '🐬', '🐳', '🐋', '🦈', '🐊', '🐅'
                ]
            },
            food: {
                name: 'Đồ ăn và thức uống',
                icon: '🍕',
                emojis: [
                    '🍏', '🍎', '🍐', '🍊', '🍋', '🍌', '🍉', '🍇',
                    '🍓', '🫐', '🍈', '🍒', '🍑', '🥭', '🍍', '🥥',
                    '🥝', '🍅', '🍆', '🥑', '🥦', '🥬', '🥒', '🌶',
                    '🫑', '🌽', '🥕', '🫒', '🧄', '🧅', '🥔', '🍠',
                    '🥐', '🥯', '🍞', '🥖', '🥨', '🧀', '🥚', '🍳',
                    '🧈', '🥞', '🧇', '🥓', '🥩', '🍗', '🍖', '🌭',
                    '🍔', '🍟', '🍕', '🫓', '🥪', '🥙', '🧆', '🌮',
                    '🌯', '🫔', '🥗', '🥘', '🫕', '🥫', '🍝', '🍜'
                ]
            },
            travel: {
                name: 'Du lịch và địa điểm',
                icon: '✈️',
                emojis: [
                    '🚗', '🚕', '🚙', '🚌', '🚎', '🏎', '🚓', '🚑',
                    '🚒', '🚐', '🛻', '🚚', '🚛', '🚜', '🦯', '🦽',
                    '🦼', '🛴', '🚲', '🛵', '🏍', '🛺', '🚨', '🚔',
                    '🚍', '🚘', '🚖', '🚡', '🚠', '🚟', '🚃', '🚋',
                    '🚞', '🚝', '🚄', '🚅', '🚈', '🚂', '🚆', '🚇',
                    '🚊', '🚉', '✈️', '🛫', '🛬', '🛩', '💺', '🛰',
                    '🚀', '🛸', '🚁', '🛶', '⛵', '🚤', '🛥', '🛳',
                    '⛴', '🚢', '⚓', '⛽', '🚧', '🚦', '🚥', '🗺'
                ]
            },
            activities: {
                name: 'Hoạt động',
                icon: '⚽',
                emojis: [
                    '⚽', '🏀', '🏈', '⚾', '🥎', '🎾', '🏐', '🏉',
                    '🥏', '🎱', '🪀', '🏓', '🏸', '🏒', '🏑', '🥍',
                    '🏏', '🥅', '⛳', '🪁', '🏹', '🎣', '🤿', '🥊',
                    '🥋', '🎽', '🛹', '🛼', '🛷', '⛸', '🥌', '🎿',
                    '⛷', '🏂', '🪂', '🏋️', '🤼', '🤸', '🤺', '⛹️',
                    '🤾', '🏌️', '🏇', '🧘', '🏊', '🤽', '🚣', '🧗',
                    '🚵', '🚴', '🏆', '🥇', '🥈', '🥉', '🏅', '🎖',
                    '🎗', '🎫', '🎟', '🎪', '🤹', '🎭', '🩰', '🎨'
                ]
            },
            objects: {
                name: 'Đồ vật',
                icon: '💡',
                emojis: [
                    '⌚', '📱', '📲', '💻', '⌨️', '🖥', '🖨', '🖱',
                    '🖲', '🕹', '🗜', '💽', '💾', '💿', '📀', '📼',
                    '📷', '📸', '📹', '🎥', '📽', '🎞', '📞', '☎️',
                    '📟', '📠', '📺', '📻', '🎙', '🎚', '🎛', '🧭',
                    '⏱', '⏲', '⏰', '🕰', '⌛', '⏳', '📡', '🔋',
                    '🔌', '💡', '🔦', '🕯', '🪔', '🧯', '🛢', '💸',
                    '💵', '💴', '💶', '💷', '🪙', '💰', '💳', '💎',
                    '⚖', '🪜', '🧰', '🪛', '🔧', '🔨', '⚒', '🛠'
                ]
            }
        };

        let currentCategory = 'smileys';
        let isPickerOpen = false;

        const emojiBtn = document.getElementById('emojiBtn');
        const emojiPicker = document.getElementById('emojiPicker');
        const messageInput = document.getElementById('body');
        const emojiGrid = document.getElementById('emojiGrid');
        const categoryBtns = document.querySelectorAll('.category-btn');
        const categoryHeader = document.getElementById('categoryHeader');
        const categoryIcon = document.getElementById('categoryIcon');
        const categoryName = document.getElementById('categoryName');

        // Toggle emoji picker
        emojiBtn.addEventListener('click', () => {
            isPickerOpen = !isPickerOpen;
            emojiPicker.classList.toggle('show');
            emojiBtn.classList.toggle('active');
        });

        // Render emojis
        function renderEmojis(category) {
            const data = emojiData[category];
            emojiGrid.innerHTML = '';
            
            data.emojis.forEach(emoji => {
                const btn = document.createElement('button');
                btn.className = 'emoji-item';
                btn.textContent = emoji;
                btn.addEventListener('click', () => {
                    messageInput.value += emoji;
                    messageInput.focus();
                });
                emojiGrid.appendChild(btn);
            });

            categoryIcon.textContent = data.icon;
            categoryName.textContent = data.name;
        }

        // Category buttons
        categoryBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                categoryBtns.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                
                const category = btn.dataset.category;
                currentCategory = category;
                renderEmojis(category);
            });
        });

        // Initial render
        renderEmojis('smileys');

        // Close picker when clicking outside
        document.addEventListener('click', (e) => {
            if (!emojiPicker.contains(e.target) && !emojiBtn.contains(e.target) && isPickerOpen) {
                isPickerOpen = false;
                emojiPicker.classList.remove('show');
                emojiBtn.classList.remove('active');
            }
        });